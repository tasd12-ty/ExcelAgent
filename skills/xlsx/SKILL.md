---
name: xlsx
description: 处理 Excel 电子表格任务 — 创建、编辑、读取、分析 .xlsx/.csv/.tsv 文件。当用户提及电子表格文件或需要将数据整理为表格格式时触发。
---

# Excel 操作 Skill

## 触发条件

用户请求涉及以下场景时激活:
- 读取/分析 Excel、CSV、TSV 文件
- 创建或修改电子表格
- 数据统计、图表生成
- 公式编写与验证

## 工具选择

| 场景 | 工具 |
|------|------|
| 数据分析、批量操作、简单导出 | pandas |
| 复杂格式、公式、Excel 特性 | openpyxl |
| 图表生成 | matplotlib |
| 图表解读 | 多模态 LLM (OpenRouter) |

## 核心原则

**公式优先**: 始终使用 Excel 公式，不在 Python 中计算后硬编码结果。

## 金融模型色彩规范

| 颜色 | 含义 |
|------|------|
| 蓝色文字 | 硬编码输入、用户可修改值 |
| 黑色文字 | 公式和计算结果 |
| 绿色文字 | 工作表内部链接 |
| 红色文字 | 外部文件链接 |
| 黄色背景 | 关键假设 |

## 数字格式规范

- 年份显示为文本 ("2024" 而非 "2,024")
- 货币使用单位表头 ("Revenue ($mm)")
- 零值显示为横线
- 百分比格式: 0.0%
- 负数使用括号

## 操作流程

1. **读取**: 使用 `tools.reader` 获取文件信息和数据
2. **分析**: 如需统计分析，使用 `tools.analyzer`
3. **修改**: 使用 `tools.writer` 写入数据和公式
4. **格式化**: 使用 `tools.formatter` 应用样式
5. **验证**: 运行 `scripts/recalc.py` 验证公式

## 公式重算

修改文件后执行:
```bash
python skills/xlsx/scripts/recalc.py <file_path>
```
